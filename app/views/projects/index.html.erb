<div class="flex flex-col">
  <h1 class="text-4xl font-bold text-gray-400 mb-6">Projects</h1>

  <div class="mb-5"
       data-controller="trash-icon"
       data-action="click@window->trash-icon#hideAllIcons">
    <ul>
      <% @projects.each do |project| %>
        <li class="flex items-center justify-between gap-2 py-2 border-b border-gray-300">
          <%= form_with model: project, url: project_path(project), method: :patch, local: true, class: "flex-grow" do |f| %>
          <div class="flex w-full">
            <div class="flex flex-col ml-2 w-full"
                 data-action="click->trash-icon#showIcon"
                 data-trash-icon-target="task">

              <%= f.text_field :title,
                  class: "w-full truncate whitespace-nowrap overflow-hidden focus:outline-none focus:bg-gray-100 border-gray-400",
                  value: project.title,
                  onchange: "this.form.submit()",
                  autocomplete: "off" %>

              <%= f.text_field :description,
                  class: "w-full truncate whitespace-nowrap break-words overflow-hidden focus:outline-none focus:bg-gray-100 border-gray-400 text-gray-500 resize-none",
                  value: project.description,
                  placeholder: "No description",
                  onchange: "this.form.submit()",
                  autocomplete: "off" %>

            </div>
          </div>
          <% end %>

          <div class="flex items-center justify-center">
            <%= button_to project_path(project),
                  method: :delete,
                  class: "text-red-300 invisible m-3",
                  data: {trash_icon_target: "icon"} do %>
                <i class="fa-solid fa-trash"></i>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  </div>

  <div>
    <%= form_with model: @project, local: true do |f| %>
      <%= f.text_field :title,
            placeholder: "Add a project",
            autocomplete: "off",
            class: "w-full whitespace-normal break-words focus:outline-none focus:border-b border-gray-400 text-gray-500" %>
      <%= f.text_field :description,
            placeholder: "Add a description",
            autocomplete: "off",
            class: "w-full whitespace-normal break-words focus:outline-none focus:border-b border-gray-400 text-gray-500" %>
      <%= f.submit "ADD" %>
    <% end %>
  </div>

  <footer class="fixed bottom-0 left-0 w-full py-4 z-50">
    <div class="flex justify-center">
      <%= link_to "Today", root_path, class:"bg-gray-200 px-4 py-2 rounded" %>
    </div>
  </footer>
</div>
